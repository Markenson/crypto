<!DOCTYPE html>
<html>
	<HEAD></HEAD>
	<BODY>
		<script language="javascript" src="./OpenCrypto.js"></script>
	</BODY>
	<script>
	const crypto = new OpenCrypto()
	var alg = "SHA-1";
	var bits = 2048;
	var plainData = 'teste123';
	var privPEM = null;
	var encData = null;
	
	console.log('Alg:' + alg)
	console.log('Bits:' + bits)
	
	crypto.getKeyPair(bits,['encrypt','decrypt'],alg,true).then(function (keyPair) {
	  window.keyPair = keyPair
	  return crypto.cryptoPrivateToPem(window.keyPair.privateKey)
	})
	.then(function(privateKeyPEM){
	  privateKeyPEM = "-----BEGIN PRIVATE KEY-----MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCgPT5+PuYYY8IVEx1ICZRKZao1MPWPpn0oFPxaro2EuWQOf5/WK25sRU2uHi1fshslhlS0rahK9E8N3CG2Bi3JA1EymTTYBGrW2MgDx/Y1kDUbHQW3DdO/WxAQVIssaR9lp3LgCgyAkBgjGXXEcjYinDqr/7Rvzlf9O8lnd8akz4uNOX77MS1Ktl+282qn6IfCQGbuTaahUFvpq/7Ur3k09esABfjWoHxprp26h5T3ZYnj32wgdF2qA5oUKglEkiFGZkA91cxNGVKGF0VIBzj3kZ8F6h7GlcFGbHTFmyaFHuM0OzrGwtyo4zOlAmroIUPznDOfnCNKPMnKgJcDh1xDAgMBAAECggEAGc7YuoXwPUwOkve0fEkUBIosncs4Nwi+Q68NmKALKa30+uN8n4ajOaD33+v7AYddbppyGMpCFBXBMx7vTF02Zpe4LjQVb21WtSp5HH109C+OaMLbNskX/6FFDGbxe2z695O+oW2SPJVOAz6IhI6jQB51fK+pz2V72ndp+tYvEkAck09V6kEXs87sP1sjYdJp0iqB0eKIKpDb7qAVEh3X4kKmQbP+szTMcIsrI1q29fi0JjcS1Ba73PJFc/nF9OLlFCg9LoBi78tvml2fEpmh1W+98BZz0l9ciqyTD5OyUOh7a16XGAWuciMBLMiCk+t25VuNn4G8MOC+jjKIykUJ8QKBgQDSx1dZkA6ZmFltZl9ZoGyPf05c+LyFGv8pI+aTeu7cTLBZztUQyr6z0A0Vuv5JRxK/5uyD3CP56eve6QJlhXDWzeciyea2/TqcaidpXGPV79gMxQOB1WNfjwJAHYluerU23Y89NhZAFNQ15Pn8wHzOplkGNqX+4betyVgcMKDETQKBgQDCnhxCYv5w2O0z798rLuR6JbRStYvXsApA/1TkYpc4i5h79DqMpcnUgAd3gnEyUcrzy1yoc/EPTwVzY7MYyt00gRD9Tr11cnInGesinv9T+8UyFfq+z9gjSbszkc15ISi3IHELSzHISXP7WJvnpxVktXmw2j0+XEYQoZcp0KQqzwKBgQDBHl9L8g9ObyXQdHF8Xt3YhB26VTP1CI0slnYWPhZHxgP15OmWnwwnF8JFXLTLUtE8/klJbxOPUOIJtJe7iI2gYbsaRr6afl2LHj/J6xqV01CyMnhKJscLsK2xLN7UWJ1cDZfFz56HTA466vaYu4weko8SgFOKuihelBGkknFaKQKBgHXUgqmTBBhQznS2k3iywHRP5bh54HwrQloN/Vj1dDcxFZZezSAgtG0rQtoRqPVdXjJy+tumrtmk71jokSO+l2VVi3LCPKUiMIkKAToJ5+7yLXdgpVrnviXHW0cizLO85sjRJIBA+5gXGNih0mrT13kNAuuXhqL9/RHOtBYGE48zAoGBALBE5BxQ0AyC79vpKbXJDO6ck+qG3jPfV2YpFThNbi220j7eCXOQEDaF90q1MZ2ARD2MSCBrNYqGLL9AfKsGOKd7C14OnEU5EVEBK4W8eYgYrOYrcssVndkY0UEznh4afaBWcpiGQ4bev7RP8jHKO3aDJ37hFsHSQGF44Cg9Q+7V-----END PRIVATE KEY-----";
	  privPEM = privateKeyPEM;
  	  console.log(privPEM)
	  return crypto.cryptoPublicToPem(window.keyPair.publicKey)
	})
	.then(function(publicKeyPEM){
	  publicKeyPEM = "-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoD0+fj7mGGPCFRMdSAmUSmWqNTD1j6Z9KBT8Wq6NhLlkDn+f1itubEVNrh4tX7IbJYZUtK2oSvRPDdwhtgYtyQNRMpk02ARq1tjIA8f2NZA1Gx0Ftw3Tv1sQEFSLLGkfZady4AoMgJAYIxl1xHI2Ipw6q/+0b85X/TvJZ3fGpM+LjTl++zEtSrZftvNqp+iHwkBm7k2moVBb6av+1K95NPXrAAX41qB8aa6duoeU92WJ499sIHRdqgOaFCoJRJIhRmZAPdXMTRlShhdFSAc495GfBeoexpXBRmx0xZsmhR7jNDs6xsLcqOMzpQJq6CFD85wzn5wjSjzJyoCXA4dcQwIDAQAB-----END PUBLIC KEY-----"
  	  console.log(publicKeyPEM)
	  return crypto.pemPublicToCrypto(publicKeyPEM)
	})
	.then(function(pubK){
	  return crypto.encryptPublic(pubK,plainData)
	})
	.then(function(encriptedData){
	  encData = encriptedData;
	  //encData = "DTfkgFbkp6WKcMUrW6MKPpbF0eh4L3z9+x4BX57VsQLSD+NyQlUJW4fX6wqWVMXQ0QymgxuRNqiOFfICa93j+5obwK2cyKMm6nJTs27h/BvBD3yHnCW4sUpC6PH3hvuw+DW/eXFeSclHshF2u7yL2xDWzpkLVSnW7mu7zI90eqTiGnoDTwW0d9JCxXpGxveZKxtbLJrZToazM/egYPV5gYSyyubWluTFNB+rfqbKvMDOna0N8KRF4D8AUbm8wDMltMvOR/gnCurdQTs60tTKZ6LR4hBu5nM+vJF8UxXd30atlrIOKHogQUQIlcxqKRt9y6+I9cm1XVWMmAJbZIne5Q=="
		debugger
	  console.log('ENCRIPTED DATA: (' + plainData  + ')')
	  console.log(encData);
  	  return crypto.pemPrivateToCrypto(privPEM)
	})
	.then(function(privK){
	  return crypto.decryptPrivate(privK,encData)
	})
	.then(function(decriptedData){
	  console.log('DECRIPTED DATA:')
	  console.log(decriptedData);
	})
	.catch(function(err){
		console.log(err)
	})

	
	
	</script>
</html>